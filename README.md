# Bioinformatic-supertool

В данном репозитории собраны инструменты для работы с нуклеотидными последовательностями.

**Точкой входа** в программу является файл `main.py`, в котором реализованы вызовы основных функций.

- В файле `data.py` содержится словарь с fastq-последовательностями. 
- В папке `utils` находятся модули с дополнительными функциями (`module_*.py`).

## Функция `dna_rna_tools`

Позволяет выполнять базовые операции с последовательности ДНК/РНК:
- проверять является ли строка нуклеотидной последовательность;
- возвращать транскрибированную, обратную, комплементарную, обратную комплементарную последовательность.

Функция **dna_rna_tools** принимает на вход произвольное количество последовательностей нуклеотидов (`str`) и тип процесса, который надо произвести над последовательностями (`str`), 
`process` — тип операции (`"is_nucleic_acid"`, `"transcribe"`, `"reverse"`, `"complement"`, `"reverse_complement"`).

**Пример использования**

```python
run_dna_rna_tools('ATGC', 'is_nucleic_acid') # True
run_dna_rna_tools('AGU', 'CCuu' 'transcribe') # ['AGT', 'CCtt']
run_dna_rna_tools('ATg', 'reverse') # 'gTA'
run_dna_rna_tools('ctA', 'complement') # 'gaT'
run_dna_rna_tools('ATg', 'reverse_complement') # 'cAT'
```

## Функция `filter_fastq`

Работает с последовательностями формата **fastq**. Позволяет фильтровать их по GC-составу, длине прочтения, качеству рида по шкале Phred33.

Функция **filter_fastq** принимает на вход 4 аргумента:
1. словарь, состоящий из fastq-сиквенсов. Ключ - имя последовательности (`str`); значение - `tuple`(последовательность (`str`) и качество (`str`)). 
2. интервал (кортеж из двух значений) или значение (`float`) GC состава (в процентах) для фильтрации. В случае одной границы фильтруются (сохраняются) все риды ниже этой границы.
3. интервал (кортеж из двух значений) или значение (`float`) длины рида для фильтрации. В случае одной границы фильтруются все риды ниже этой границы.
4. пороговое значение среднего качества рида для фильтрации (`int`). Риды с качеством ниже порогового значения отбрасываются.

Возвращает словарь из fastq-сиквенсов, отфильтрованный по заданным параметрам.

```python
filter_fastq(
    seqs: dict[str, tuple[str, str]],
    gc_bounds: tuple[float, float] | float = (0, 100),
    length_bounds: tuple[int, int] | int = (0, 2**32),
    quality_threshold: float = 0
) -> dict[str, tuple[str, str]]
```

**Пример использования**
```python
filter_fastq(seqs, gc_bounds = (0,100), length_bounds = (0,2**32),
        quality_threshold = 0)
```
